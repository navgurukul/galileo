{"version":3,"file":"dependencies.spec.js","sourceRoot":"","sources":["../../src/lib/dependencies.spec.ts"],"names":[],"mappings":"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","sourcesContent":["import test = require('blue-tape')\nimport { join } from 'path'\nimport { EventEmitter } from 'events'\nimport { resolveAllDependencies, resolveDependency } from './dependencies'\nimport { DependencyTree, DependencyBranch } from '../interfaces'\n\nconst FIXTURE_DIR = join(__dirname, '__test__/fixtures')\nconst emitter = new EventEmitter()\n\ntest('dependencies', t => {\n  const RESOLVE_FIXTURE_DIR = join(__dirname, '__test__/fixtures/resolve')\n\n  t.test('resolve fixture', t => {\n    t.test('resolve a dependency tree', t => {\n      const expected: DependencyTree = {\n        raw: undefined,\n        global: undefined,\n        postmessage: undefined,\n        name: 'foobar',\n        src: join(RESOLVE_FIXTURE_DIR, 'typings.json'),\n        main: 'foo.d.ts',\n        files: undefined,\n        version: undefined,\n        browser: undefined,\n        typings: undefined,\n        browserTypings: undefined,\n        dependencies: {},\n        devDependencies: {},\n        peerDependencies: {},\n        globalDependencies: {},\n        globalDevDependencies: {}\n      }\n\n      const bowerDep: DependencyTree = {\n        raw: 'bower:bower-dep',\n        global: undefined,\n        postmessage: undefined,\n        src: join(RESOLVE_FIXTURE_DIR, 'bower_components/bower-dep/bower.json'),\n        typings: 'bower-dep.d.ts',\n        browserTypings: undefined,\n        dependencies: {},\n        devDependencies: {},\n        peerDependencies: {},\n        globalDependencies: {},\n        globalDevDependencies: {},\n        name: 'bower-dep',\n        files: undefined,\n        version: undefined,\n        main: 'index.js',\n        browser: undefined\n      }\n\n      const exampleDep: DependencyTree = {\n        raw: 'bower:example',\n        global: undefined,\n        postmessage: undefined,\n        src: join(RESOLVE_FIXTURE_DIR, 'bower_components/example/bower.json'),\n        main: undefined,\n        browser: undefined,\n        files: undefined,\n        version: undefined,\n        typings: undefined,\n        browserTypings: undefined,\n        name: 'example',\n        dependencies: {},\n        devDependencies: {},\n        peerDependencies: {},\n        globalDependencies: {},\n        globalDevDependencies: {}\n      }\n\n      const typedDep: DependencyTree = {\n        raw: 'file:typings/dep.d.ts',\n        global: undefined,\n        postmessage: undefined,\n        src: join(RESOLVE_FIXTURE_DIR, 'typings/dep.d.ts'),\n        typings: join(RESOLVE_FIXTURE_DIR, 'typings/dep.d.ts'),\n        main: undefined,\n        browser: undefined,\n        files: undefined,\n        version: undefined,\n        browserTypings: undefined,\n        dependencies: {},\n        devDependencies: {},\n        peerDependencies: {},\n        globalDependencies: {},\n        globalDevDependencies: {}\n      }\n\n      const npmDep: DependencyTree = {\n        raw: 'npm:npm-dep',\n        global: undefined,\n        postmessage: undefined,\n        src: join(RESOLVE_FIXTURE_DIR, 'node_modules/npm-dep/package.json'),\n        main: './index.js',\n        browser: undefined,\n        files: undefined,\n        version: undefined,\n        typings: undefined,\n        browserTypings: undefined,\n        name: 'npm-dep',\n        dependencies: {},\n        devDependencies: {},\n        peerDependencies: {},\n        globalDependencies: {},\n        globalDevDependencies: {}\n      }\n\n      const typedDevDep: DependencyTree = {\n        globalDependencies: {},\n        globalDevDependencies: {},\n        browser: undefined,\n        browserTypings: undefined,\n        dependencies: {},\n        devDependencies: {},\n        peerDependencies: {},\n        main: undefined,\n        name: 'dep',\n        raw: 'bower:dep',\n        global: undefined,\n        postmessage: undefined,\n        src: join(RESOLVE_FIXTURE_DIR, 'bower_components/dep/bower.json'),\n        typings: undefined,\n        files: undefined,\n        version: undefined\n      }\n\n      ;(expected as any).dependencies['bower-dep'] = bowerDep\n      ;(expected as any).dependencies.dep = typedDep\n      ;(expected as any).dependencies['npm-dep'] = npmDep\n      ;(expected as any).devDependencies['dev-dep'] = typedDevDep\n\n      ;(bowerDep as any).dependencies.example = exampleDep\n\n      return resolveAllDependencies({\n        cwd: RESOLVE_FIXTURE_DIR,\n        dev: true,\n        emitter\n      })\n        .then((result) => {\n          t.equal(result.parent, undefined)\n          t.ok((result.dependencies as any).dep.parent != null)\n          t.ok((result.dependencies as any)['npm-dep'].parent != null)\n\n          removeParentReference(result)\n\n          t.deepEqual(result, expected)\n        })\n    })\n  })\n\n  t.test('jspm module without package.json', t => {\n    const cwd = join(FIXTURE_DIR, 'jspm-typings-registry')\n\n    const jspmDep = {\n      raw: 'jspm:make-error',\n      type: 'jspm',\n      location: 'make-error',\n      meta: {\n        name: 'make-error'\n      }\n    }\n\n    const makeErrorDep: DependencyTree = {\n      src: join(cwd, 'jspm_packages/npm/make-error@1.2.0/package.json'),\n      raw: 'jspm:make-error',\n      main: undefined,\n      browser: undefined,\n      typings: undefined,\n      browserTypings: undefined,\n      version: undefined,\n      files: undefined,\n      global: undefined,\n      postmessage: undefined,\n      dependencies: {},\n      devDependencies: {},\n      peerDependencies: {},\n      globalDependencies: {},\n      globalDevDependencies: {},\n      parent: undefined,\n      name: undefined\n    }\n    return resolveDependency(jspmDep, { cwd, emitter })\n      .then(actual => {\n        t.deepEqual(actual, makeErrorDep)\n      })\n  })\n\n  t.test('jspm resolve dependency', t => {\n    const cwd = join(FIXTURE_DIR, 'jspm-typings-github')\n\n    const jspmDep = {\n      raw: 'jspm:unthenify',\n      type: 'jspm',\n      location: 'unthenify',\n      meta: {\n        name: 'unthenify'\n      }\n    }\n\n    const utilArityDep: DependencyTree = {\n      src: join(cwd, 'jspm_packages/npm/util-arity@1.0.2/package.json'),\n      raw: 'jspm:util-arity',\n      main: 'arity.js',\n      browser: undefined,\n      typings: 'arity.d.ts',\n      browserTypings: undefined,\n      version: '1.0.2',\n      files: undefined,\n      global: undefined,\n      postmessage: undefined,\n      dependencies: {},\n      devDependencies: {},\n      peerDependencies: {},\n      globalDependencies: {},\n      globalDevDependencies: {},\n      name: 'util-arity'\n    }\n\n    const utilArityParent: DependencyTree = {\n      src: join(cwd, 'jspm_packages/npm/unthenify@1.0.2/package.json'),\n      raw: 'jspm:unthenify',\n      main: 'dist/index.js',\n      browser: undefined,\n      typings: undefined,\n      browserTypings: undefined,\n      version: '1.0.2',\n      files: undefined,\n      global: undefined,\n      postmessage: undefined,\n      dependencies: {\n        'util-arity': utilArityDep\n      },\n      devDependencies: {},\n      peerDependencies: {},\n      globalDependencies: {},\n      globalDevDependencies: {},\n      name: 'unthenify'\n    }\n\n    const es6PromiseDep: DependencyTree = {\n      src: 'https://raw.githubusercontent.com/typings/typed-es6-promise/' +\n      '94aac67ef7a14a8de8e9e1d3c1f9a26caa0d9fb1/typings.json',\n      raw: 'github:typings/typed-es6-promise#94aac67ef7a14a8de8e9e1d3c1f9a26caa0d9fb1',\n      main: 'dist/es6-promise.d.ts',\n      browser: undefined,\n      typings: undefined,\n      browserTypings: undefined,\n      version: undefined,\n      files: undefined,\n      global: undefined,\n      postmessage: undefined,\n      dependencies: {},\n      devDependencies: {},\n      peerDependencies: {},\n      globalDependencies: {},\n      globalDevDependencies: {},\n      name: 'es6-promise'\n    }\n\n    const es6PromiseParent: DependencyTree = {\n      src: join(cwd, 'jspm_packages/npm/unthenify@1.0.2/typings.json'),\n      raw: 'jspm:unthenify',\n      main: undefined,\n      browser: undefined,\n      typings: undefined,\n      browserTypings: undefined,\n      version: undefined,\n      files: undefined,\n      global: undefined,\n      postmessage: undefined,\n      dependencies: { 'es6-promise': es6PromiseDep },\n      devDependencies: {},\n      peerDependencies: {},\n      globalDependencies: {},\n      globalDevDependencies: {},\n      name: undefined\n    }\n\n    const unthenifyDep: DependencyTree = {\n      src: join(cwd, 'jspm_packages/npm/unthenify@1.0.2/package.json'),\n      raw: 'jspm:unthenify',\n      main: 'dist/index.js',\n      browser: undefined,\n      typings: undefined,\n      browserTypings: undefined,\n      version: '1.0.2',\n      files: undefined,\n      global: undefined,\n      postmessage: undefined,\n      dependencies: {\n        'util-arity': utilArityDep,\n        'es6-promise': es6PromiseDep\n      },\n      devDependencies: {},\n      peerDependencies: {},\n      globalDependencies: {},\n      globalDevDependencies: {},\n      name: 'unthenify'\n    }\n\n    return resolveDependency(jspmDep, { cwd, emitter })\n      .then(actual => {\n        t.is(actual.parent, undefined, 'top of result should have no parent')\n\n        t.true(actual.dependencies['util-arity'], '`util-arity` is a dependency')\n        const actualUtilArityParent = actual.dependencies['util-arity'].parent\n        removeParentReference(actualUtilArityParent)\n        t.deepEqual(actualUtilArityParent, utilArityParent, '`util-arity` has correct parent')\n\n        t.true(actual.dependencies['es6-promise'], '`es6-promise` is a dependency')\n        const actualEs6PromiseParent = actual.dependencies['es6-promise'].parent\n        removeParentReference(actualEs6PromiseParent)\n        t.deepEqual(actualEs6PromiseParent, es6PromiseParent, '`es6-promise` has correct parent')\n\n        removeParentReference(actual)\n        t.deepEqual(actual, unthenifyDep, 'result as expected (after parent removed to avoid circular reference)')\n      })\n  })\n})\n\nfunction removeParentReference (tree: DependencyTree) {\n  delete tree.parent\n\n  removeParentReferenceFromDependencies(tree.dependencies)\n  removeParentReferenceFromDependencies(tree.devDependencies)\n  removeParentReferenceFromDependencies(tree.peerDependencies)\n  removeParentReferenceFromDependencies(tree.globalDependencies)\n  removeParentReferenceFromDependencies(tree.globalDevDependencies)\n\n  return tree\n}\n\nfunction removeParentReferenceFromDependencies (dependencies: DependencyBranch) {\n  Object.keys(dependencies).forEach(function (key) {\n    removeParentReference(dependencies[key])\n  })\n}\n"]}